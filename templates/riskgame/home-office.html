{% extends "base.html" %}

{% block pagetitle %}Home{% endblock %}

{% block content %}

	{# TODO what to do if we have several messages? (can happen with system pushed stuff) #}

	{% if messages %}
	    {% for message in messages %}

            <section class="modal message">
                <div class="row">
                    <div class="sheet large-12 columns">

                        <h2>Header</h2>

                        {{ message }}

                        <a href="#" class='medium dismiss btn' onclick='window.location.reload()'>Okay</a>

                    </div>
                </div>
            </section>


	    {% endfor %}
    {% else %}

        <section class="game-ui office">

            <div id="events">
                <!--{{ teamplayer.active_events }}-->

                <div class="event tornado">
                    <div>
                        <span>Your event</span>
                        Tornado
                    </div>
                </div>
                <div class="event caution">
                    <div>
                        <span>Team event</span>
                        Increased Risk
                    </div>
                </div>
                <div class="event high-market">
                    <div>
                        <span>Your event</span>
                        High Market
                    </div>
                </div>
                <div class="event lightning">
                    <div>
                        <span>Your event</span>
                        Lightning
                    </div>
                </div>

            </div>

            <div id="safety-box" class="sheet">
                <header>
                    <h5>
                        Safety
                        <span data-tooltip class="help has-tip" title="Check and improve the safety of your station">?</span>
                    </h5>
                </header>

                <div class="safety-stack gutter-pad-h half-gutter-pad-top half-gutter-pad-bot">
                    <form method="POST" action="{% url 'play_inspect' %}">{% csrf_token %}
                        <input type="hidden" name="pile" value="risk">
                        <input type="submit" class="tiny safety action btn" value="Inspect">
                    </form>

                    <form method="POST" action="{% url 'play_invest' %}">{% csrf_token %}
                        <input type="hidden" name="pile" value="risk">
                        <input type="submit" class="tiny safety action btn" value="Improve">
                    </form>
                </div>
            </div>

            <div id="quality-box" class="sheet">
                <header>
                    <h5>
                        Production Quality
                        <span data-tooltip class="help has-tip" title="Check and improve your production capacity">?</span>
                    </h5>
                </header>

                <div class="quality-stack gutter-pad-h half-gutter-pad-top half-gutter-pad-bot">
                    <form method="POST" action="{% url 'play_inspect' %}">{% csrf_token %}
                        <input type="hidden" name="pile" value="gather">
                        <input type="submit" class="tiny production action btn" value="Inspect">
                    </form>

                    <form method="POST" action="{% url 'play_invest' %}">{% csrf_token %}
                        <input type="hidden" name="pile" value="gather">
                        <input type="submit" class="tiny production action btn" value="Improve">
                    </form>
                </div>
            </div>

            <div id="production-box" class="sheet">
                <header>
                    <h5>
                        Resource Production
                        <span data-tooltip class="help has-tip" title="Place barriers, plan production and produce resources">?</span>
                    </h5>
                </header>

                <div class="production-plan">
                    <form class="relative" method="POST" action="{% url 'play_prevent' %}">{% csrf_token %}
                        <input type="submit" class="tiny barrier action btn" value="Place barrier">
                        <span class="barrier badge">{{ current_teamplayer.prevent_markers }}</span>
                    </form>

                    <form class="relative" method="POST" action="{% url 'play_gather' %}">{% csrf_token %}
                        <input type="submit" class="tiny plan action btn" value="Plan production">
                        <span class="production badge">{{ current_teamplayer.gather_markers }}</span>
                    </form>
                </div>

                <div class="production-produce">
                    <form method="POST" action="{% url 'play_pump' %}">{% csrf_token %}
                        <input type="submit"  class="tiny produce btn" value="Produce resources">
                    </form>
                </div>

            </div>

            <div id="messages-box" class="sheet">
                <header>
                    <h5>
                        Messages
                        <span data-tooltip class="help has-tip" title="See what other team members are up to">?</span>
                    </h5>
                </header>

                {% if notifications|length > 0 %}
                    {% for notification in notifications %}
                        {% include "partials/notification.html" %}
                    {% endfor %}
                {% else %}
                    <div class="notification clearfix">
                        <div class="message clearfix">
                            No messages.
                        </div>
                    </div>
                {% endif %}
            </div>


            <div class="ui-box sheet">
                <header>
                    <h5>
                        Start a new game
                    </h5>
                </header>

                <div class="ui-box-content">
                    <form method="POST" action="{% url 'game_start' %}">
                        {% csrf_token %}
                        {{ startform }}
                        <input type="submit">
                    </form>
                </div>

            </div>



        </section>


    {% endif %}

	{% endblock content %}